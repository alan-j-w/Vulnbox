{% extends 'base.html' %}

{% block title %}Model Theft Lab{% endblock %}

{% block extra_head %}
<style>
    .ui-panel { background: rgba(20, 20, 25, 0.6); border: 1px solid rgba(57, 255, 20, 0.2); backdrop-filter: blur(8px); border-radius: 12px; }
</style>
{% endblock %}

{% block content %}
<div class="w-full max-w-xl mx-auto text-white">
    <div class="ui-panel p-8 text-center">
        <h2 class="text-3xl font-bold text-green-400 mb-4">The Oracle AI</h2>
        <p class="text-gray-400 mb-6">The Oracle AI has chosen a secret number between 1 and 1000. Your goal is to query the API to discover this number. This represents stealing a model's core parameter.</p>

        <!-- Messages Display -->
        {% if message %}
            <div class="mb-6 bg-blue-500/20 text-blue-300 p-3 rounded-md text-sm" role="alert">
                {{ message }}
            </div>
        {% endif %}
        
        {% if error %}
        <div class="mt-6 bg-red-500/20 text-red-300 p-3 rounded-md text-sm">
            {{ error }}
        </div>
        {% endif %}

        <!-- Form for guessing -->
        <form method="POST" class="mb-8">
            {% csrf_token %}
            <div class="flex items-center gap-4">
                <input type="number" name="guess" min="1" max="1000" required class="flex-grow w-full bg-gray-900/50 border-2 border-green-700 rounded-md p-3 text-white focus:outline-none focus:ring-2 focus:ring-green-400 font-mono" placeholder="Enter your guess...">
                <button type="submit" class="bg-green-600 text-black font-bold py-3 px-8 rounded-lg hover:bg-green-500 transition-colors">
                    Query Oracle
                </button>
            </div>
        </form>

        <!-- Query History -->
        <div>
            <h3 class="text-xl font-bold text-gray-200 mb-4">Query History:</h3>
            <div class="space-y-2 max-h-48 overflow-y-auto p-4 bg-black/30 rounded-md text-left">
                {% for item in query_history %}
                    <p class="font-mono text-sm">Your guess: <span class="text-yellow-400">{{ item.guess }}</span> -> Oracle's Response: <span class="font-bold text-cyan-400">{{ item.response }}</span></p>
                {% empty %}
                    <p class="text-gray-500 italic">No queries made yet.</p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
